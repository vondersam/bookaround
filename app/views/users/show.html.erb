<%= content_for(:title) do %>
  Tsundoku | <%= @user.first_name + ' ' + @user.last_name %>
<% end %>

<div class="row">
  <div class="col-xs-3">
    <div>
      <% avatar_url = @user.facebook_picture_url || @user.profile_pic_url || "http://placehold.it/30x30" %>
      <%= image_tag avatar_url, {class: "avatar-profile-square"} %>
    </div>
    <% if current_user == User.find(params[:id]) %>
      <%= link_to "Add a book", new_physical_book_path, class: "btn btn-primary" %>
      <%= link_to "Edit profile", edit_user_registration_path, class: "btn btn-primary" %>
    <% else %>
      <%= link_to "Chat", new_message_path(to: @user), class: "btn btn-primary" %>
      <%= link_to "See all books", index_of_books_path(@user), class: "btn btn-primary" %>
    <% end %>
  </div>
  <div class="col-xs-5">
    <h2><%= @user.first_name %><%= " " %><%= @user.last_name %></h2>
    <div>
      <% if !@user.city %>
        <%= link_to "Add your address", edit_user_registration_path %>
      <% else %>
        <p><%= @user.city %> Â· <%= @user.country %></p>
      <% end %>
    </div>
    <div>
      <% if !@user.bio %>
        <%= link_to "Say something about you", edit_user_registration_path %>
      <% else %>
        <p><%= @user.bio %></p>
      <% end %>
    </div>
  </div>
  <div class="col-xs-4">
    <% unless current_user == @user %>
      <div id="map" style="width: 100%; height: 385px;">
      </div>
      <% content_for(:after_js) do %>
        <script type="text/javascript">
          $(document).on('ready', function() {
            var handler = Gmaps.build('Google');
            var mapOptions = {
              center: new google.maps.LatLng(<%=@user.latitude %>,<%=@user.longitude %>),
              zoom: 10,
              scrollwheel: false,
              styles: [{"featureType":"landscape","elementType":"all","stylers":[{"hue":"#FFBB00"},{"saturation":43.400000000000006},{"lightness":37.599999999999994},{"gamma":1}]},{"featureType":"poi","elementType":"all","stylers":[{"hue":"#00FF6A"},{"saturation":-1.0989010989011234},{"lightness":11.200000000000017},{"gamma":1}]},{"featureType":"road.highway","elementType":"all","stylers":[{"hue":"#FFC200"},{"saturation":-61.8},{"lightness":45.599999999999994},{"gamma":1}]},{"featureType":"road.arterial","elementType":"all","stylers":[{"hue":"#FF0300"},{"saturation":-100},{"lightness":51.19999999999999},{"gamma":1}]},{"featureType":"road.local","elementType":"all","stylers":[{"hue":"#FF0300"},{"saturation":-100},{"lightness":52},{"gamma":1}]},{"featureType":"water","elementType":"all","stylers":[{"hue":"#0078FF"},{"saturation":-13.200000000000003},{"lightness":2.4000000000000057},{"gamma":1}]}]
        };
            handler.buildMap({ provider: mapOptions, internal: { id: 'map' } }, function(){
              markers = handler.addMarkers(<%= raw @hash.to_json %>);
            });
          });
        </script>
      <% end %>
    <% end %>
  </div>
</div>
<div class="row">
   <%= render "users_book_card" %>
</div>

